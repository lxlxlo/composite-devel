#!/bin/sh

#
# Hydrogen configuration script.
# (c)2006 Alessandro Cominu
#


# remove old files before starting a new configuration
rm -f all.mak

echo "

-----------------------------------------------------------------
Starting Hydrogen configuration...
-----------------------------------------------------------------

"

if test "x$QTDIR" = "x"; then
	# is not set
	echo " * QTDIR is not set."
	echo ""

	echo " * Guessing for QT library"
	ac_qtlib=""
	for X in \
			/usr/local/Trolltech/Qt-4.3.0 \
			/usr/local/Trolltech/Qt-4.2.0 \
			/usr/local/Trolltech/Qt-4.1.3 \
			/usr/local/Trolltech/Qt-4.1.2 \
			/usr/local/Trolltech/Qt-4.1.1 \
			/usr/local/Trolltech/Qt-4.1.0 \
			/usr \
			; do
		if test "x$ac_qtlib" = "x"; then
			if test -f $X/lib/libQtCore.a -o -f $X/lib/libQtCore.so -o -d $X/lib/QtCore.framework -o -f $X/lib/libQtCore.dylib; then
				ac_qtlib=$X
				QTDIR=$X
				echo "   |-> searching in $X [ OK ]"
			else
				echo "   |-> searching in $X"
			fi
		fi
	done
else
	echo " * QTDIR = $QTDIR"
	echo ""
	ac_qtlib=""
	if test "x$ac_qtlib" = "x"; then
		if test -f $QTDIR/lib/libQtCore.so -o -f $QTDIR/lib/libQtCore.a -o -f $QTDIR/lib/libQtCore_debug.so -o -f $QTDIR/lib/libQtCore_debug.a -o -d $QTDIR/lib/QtCore.framework -o -f $QTDIR/lib/libQtCore.dylib; then
			ac_qtlib=$QTDIR
			echo " * Searching for QT library in $QTDIR [ OK ]"
		else
			echo " * Searching for QT library in $QTDIR *** Not found ***"
		fi
	fi
fi

if test "x$ac_qtlib" = "x"; then
	echo ""
	echo " *** ERROR: QT library not found. Maybe QTDIR isn't properly set."
	exit 1
fi


prefix=/usr/local

echo ""
echo " * Creating all.mak..."
#$QTDIR/bin/qmake -o all.mak all.pro

$QTDIR/bin/qmake all.pro \
"prefix=$prefix"

rm -f config.h
echo "#define CONFIG_PREFIX \"$prefix\"" >> config.h
echo "#define DATA_PATH \"$prefix/share/hydrogen/data\"" >> config.h

echo "

-----------------------------------------------------------------
Hydrogen is now configured for building. Just run 'make'.
Once everything is built, you must run 'make install'.

Hydrogen will be installed in $prefix prefix by default.
"
#you can override this setting with:
#'make prefix=/your/preferred/prefix'
#and then
#'make prefix=/your/preferred/prefix install'
echo "
See the INSTALL file for details.

[http://www.hydrogen-music.org]
-----------------------------------------------------------------

"

